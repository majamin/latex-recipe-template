\ProvidesPackage{style/recipes}[2025/08/09 v1.5 Minimalist recipe styling]

% ---------------------------------------------------------------
% Core packages
% ---------------------------------------------------------------
\RequirePackage{calc}
\RequirePackage{xcolor,enumitem}
\RequirePackage{tcolorbox}
\tcbuselibrary{skins,raster}

% ---------------------------------------------------------------
% Font styling
% ---------------------------------------------------------------
\providecommand{\headingfont}{\normalfont\bfseries}
\newcommand{\AmountStyle}[1]{{\normalfont\color{black!80}\scshape\small #1}}

% ---------------------------------------------------------------
% List styles
% ---------------------------------------------------------------
\newlength{\ingsep}
\setlength{\ingsep}{0.8em}        % ← adjust this to taste

\newlist{inglist}{description}{1}
\setlist[inglist]{%
	style=multiline,
	widest={3 cups},
	labelsep=\ingsep,
	leftmargin=*,
	align=parleft,
	before=\raggedright,
	font=\AmountStyle,
	itemsep=.25em,
}

\newlist{dirlist}{enumerate}{1}
\setlist[dirlist]{label=\arabic*.,leftmargin=*,itemsep=.6em}

% Row helpers
\newlength{\ingredFullW}
\newlength{\ingredLeftW}
\newlength{\ingredRightW}

\RequirePackage{xparse}
\NewDocumentCommand{\ingred}{ s o m }{%
	\IfBooleanTF{#1}{% ★: equal split (50/50)
		\item[]%
		\begingroup
		\setlength{\ingredFullW}{\dimexpr \labelwidth+\labelsep+\linewidth\relax}%
		\setlength{\ingredLeftW}{\dimexpr .5\ingredFullW - .5\ingsep\relax}%
		\setlength{\ingredRightW}{\dimexpr .5\ingredFullW - .5\ingsep\relax}%
		\noindent\hspace*{-\labelwidth}\hspace*{-\labelsep}%
		\parbox[t]{\ingredLeftW}{%
			\raggedright\normalsize\strut
			\IfNoValueTF{#2}{}{%
				{\AmountStyle{#2}}
			}%
		}%
		\hspace{\ingsep}%
		\parbox[t]{\ingredRightW}{\raggedright\normalsize\strut #3}%
		\par
		\endgroup
	}{%
		% unstarred: unchanged – enumitem applies font={...} above to the label
		\IfNoValueTF{#2}{\item[] #3}{\item[\mbox{\AmountStyle{#2}}] #3}%
	}%
}


\newcommand{\ingredNoQty}[1]{\item[] #1}
\newcommand{\direct}[1]{\item #1}

% ---------------------------------------------------------------
% Shared tcolorbox
% ---------------------------------------------------------------
\tcbset{
	recipebox/.style={
			enhanced,
			arc=0.1mm,
			top=5mm,bottom=5mm,
			colback=white,
			colframe=black!50,
			colbacktitle=white,
			fonttitle=\headingfont,
			coltitle=black,
			boxed title style={boxrule=0pt,colframe=white},
			attach boxed title to top left={
					yshift=-\tcboxedtitleheight/2,
					xshift=0.15in
				},
			valign=top
		}
}

% ---------------------------------------------------------------
% Header macros
% ---------------------------------------------------------------
\newcommand{\recipesTitle}{}        % internal storage
\newcommand{\recipesDesc}{}         %   ”
\newcommand{\recipesInfo}{}         %   ”

\newcommand{\recipeTitle}[1]{\gdef\recipesTitle{#1}}
\newcommand{\recipeDescription}[1]{\gdef\recipesDesc{#1}}
\newcommand{\recipeInfo}[1]{\gdef\recipesInfo{#1}}

% ---------------------------------------------------------------
% 13-column raster wrapper + header output
% ---------------------------------------------------------------
\NewDocumentEnvironment{Recipe}{ O{13} }{%
	% ---------- header ----------
	{\centering
			{\headingfont\Huge\leavevmode\recipesTitle\par}\vspace{.6em}%
			{\sffamily\small\itshape\leavevmode\recipesDesc\par}\vspace{1em}%
			\noindent\hrule height 1pt\par\vspace{.5em}%
			{\leavevmode\recipesInfo\par}\vspace{.5em}%
			\noindent\hrule height 2pt\par\vspace{1.5em}%
		}%
	% ---------- 13-column raster ----------
	\begin{tcbraster}[
			raster columns = #1,
			raster column skip = 2mm,
			raster equal height
		]%
		}{%
	\end{tcbraster}
}

% ---------------------------------------------------------------
% Ingredient & Direction boxes
% ---------------------------------------------------------------
\NewDocumentEnvironment{RecipeIngredients}{ }{%
	\begin{tcolorbox}[recipebox,
			title={\MakeUppercase{\large Ingredients}},raster multicolumn=5]%
		\begin{inglist}
			}{%
		\end{inglist}
	\end{tcolorbox}\ignorespacesafterend
}

\NewDocumentEnvironment{RecipeDirections}{ }{%
	\begin{tcolorbox}[recipebox,
			title={\MakeUppercase{\large Directions}},raster multicolumn=8]%
		\begin{dirlist}
			}{%
		\end{dirlist}
	\end{tcolorbox}\ignorespacesafterend
}

% ---------------------------------------------------------------
% Optional note box
% ---------------------------------------------------------------
\NewDocumentEnvironment{RecipeNote}{ }{%
	\par\vspace{1.5em}\noindent
	\begin{minipage}[t]{0.1\linewidth}
		\raggedright\sffamily\bfseries\small NOTE
	\end{minipage}%
	\hspace{0.6em}%   ← was 0.2em; adjust as you like
	\begin{minipage}[t]{0.8\linewidth}\itshape
		}{%
	\end{minipage}\par\vspace{1.5em}
}
