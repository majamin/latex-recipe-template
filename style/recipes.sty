\ProvidesPackage{style/recipes}[2025/08/01 v1.2 Minimalist recipe styling]

% === Dependencies ===
\RequirePackage[most]{tcolorbox}
\tcbuselibrary{raster}
\RequirePackage{enumitem}
\RequirePackage{xparse}
\RequirePackage{array}

\providecommand{\headingfont}{\normalfont\bfseries}

% === Todo-style ingredient list using checkboxes ===
\newlist{inglist}{itemize}{1}
\setlist[inglist]{label={}, leftmargin=*, itemsep=0.4em, topsep=0pt, parsep=0pt}

% === Directions list with automatic numbers ===
\newlist{dirlist}{enumerate}{1}
\setlist[dirlist]{label=\arabic*., leftmargin=*, itemsep=0.75em}

% === Item Macros ===
% \ingred[<amount>]{<ingredient>}
\NewDocumentCommand{\ingred}{ o m }{%
	\item\leavevmode
	\begin{tabular}[t]{@{}%
		>{\raggedleft\arraybackslash}p{0.22\linewidth}%
		@{\hspace{1em}}%
		>{\raggedright\arraybackslash}p{0.74\linewidth}@{}}%
		\IfNoValueTF{#1}{%
			% No amount: keep left column (blank) so alignment matches
		\mbox{}                                                                               & #2 %
		}{%
			% With amount: amount | ingredient
		\raisebox{\dimexpr-\height+0.75\ht\strutbox\relax}{\color{black!80}\scshape\small #1} & #2 %
		}%
	\end{tabular}%
}

\newcommand{\direct}[1]{\item #1}

% === Recipe Title and Info Storage ===
\newcommand{\recipeTitle}[1]{\def\@recipeTitle{#1}}
\newcommand{\recipeDescription}[1]{\def\@recipeDescription{#1}}
\newcommand{\recipeInfo}[1]{\def\@recipeInfo{#1}}

% default empty fallback
\def\@recipeDescription{}

% === Recipe Layout Container ===
\NewDocumentEnvironment{Recipe}{ O{13} }{%
	\clearpage
	{\centering
		{\headingfont\Huge\bfseries \@recipeTitle \par}
		\vspace{0.6em}
		{\sffamily\small\itshape \@recipeDescription \par}
		\vspace{1.0em}
		\noindent\hrule height 1pt
		\vspace{0.5em}
		{\@recipeInfo \par}
		\vspace{0.5em}
		\noindent\hrule height 2pt
		\vspace{1.5em}
	}
	\begin{tcbraster}[
			raster columns=#1,
			raster equal height,
			raster column skip=2mm
		]
		}{%
	\end{tcbraster}
}

% === Box Styling ===
\tcbset{
	recipebox/.style={
			lower separated=false,
			arc=0.1mm,
			top=5mm,
			bottom=5mm,
			colback=white,
			colframe=black!50,
			colbacktitle=white,
			coltitle=black,
			fonttitle=\headingfont,
			enhanced,
			attach boxed title to top left={
					yshift=-\tcboxedtitleheight/2, % <-- tcolorbox supports "/2" here
					xshift=0.15in
				},
			boxed title style={boxrule=0pt, colframe=white},
		}
}

% === Recipe Content Boxes ===

% Ingredients: checkbox list (via todolist)
\newtcolorbox{RecipeIngredients}[1][]{
	recipebox,
	raster multicolumn=5,
	title=\uppercase{\large\textbf{ingredients}},
	before upper={\begin{inglist}},
				after upper={\end{inglist}},
	#1
}

% Directions: numbered list
\newtcolorbox{RecipeDirections}[1][]{
	recipebox,
	raster multicolumn=8,
	title=\uppercase{\large\textbf{directions}},
	before upper={\begin{dirlist}},
				after upper={\end{dirlist}},
	#1
}

% === Optional Note Box ===
\NewDocumentEnvironment{RecipeNote}{ O{} }{%
	\par\vspace{1.5em}
	\noindent
	\begin{minipage}[t]{0.1\linewidth}
		\raggedright\sffamily\bfseries\small NOTE
	\end{minipage}%
	\hspace{0.2em}%
	\begin{minipage}[t]{0.83\linewidth}
		\itshape
		}{%
	\end{minipage}
	\par\vspace{1.5em}
}
